System.register("chunks:///_virtual/Down2048AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Down2048GameManager.ts","./Down2048Tool.ts"],(function(o){var e,n,i,t,u,s,l,a,r,c,d,p;return{setters:[function(o){e=o.inheritsLoose},function(o){n=o.cclegacy,i=o._decorator,t=o.find,u=o.assetManager,s=o.AudioClip,l=o.Slider,a=o.ProgressBar,r=o.AudioSource,c=o.Component},function(o){d=o.Down2048GameManager},function(o){p=o.Down2048Tool}],execute:function(){var g;n._RF.push({},"9855fztnO9DHp2ClwjeP2ZK","Down2048AudioManager",void 0);var h=i.ccclass;i.property,o("Down2048AudioManager",h("Down2048AudioManager")(g=function(o){function n(){for(var e,n=arguments.length,i=new Array(n),t=0;t<n;t++)i[t]=arguments[t];return(e=o.call.apply(o,[this].concat(i))||this).musicVolume=.8,e.soundVolume=.8,e.musicAudioSource=new r,e.soundAudioSource=new r,e.bgmClip=null,e.btnClickClip=null,e.downClip=null,e.mergeClip=null,e.goodClip=null,e.unbeliveableClip=null,e.gameFailClip=null,e.gameSuccessClip=null,e.gameManager=null,e.settingPopupNode=null,e}e(n,o);var i=n.prototype;return i.onLoad=function(){this.gameManager=t("Down2048GameManager").getComponent(d),this.settingPopupNode=t("Canvas/SettingPopup")},i.start=function(){this.updateProgress("sound"),this.updateProgress("music")},i.onDestroy=function(){this.musicAudioSource.stop(),this.soundAudioSource.stop()},i.loadAssert=function(){var o=this;return new Promise((function(e,n){var i={bgmClip:"bgm",btnClickClip:"btnClick",downClip:"move",mergeClip:"eliminate",goodClip:"good",unbeliveableClip:"unbeliveable",gameFailClip:"game_fail",gameSuccessClip:"game_success"},t=[];Object.keys(i).forEach((function(e){var n=i[e];t.push(new Promise((function(i,t){u.loadBundle("music",(function(u,l){u||l.load(n,s,(function(n,u){if(n)return console.log("load err:",n),void t(n);o[e]=u,i(0)}))}))})))})),Promise.all([].concat(t)).then((function(o){e(0)}))}))},i.onSliderChange=function(o,e){"sound"===e?this.soundVolume=o.progress:"music"===e&&(this.musicVolume=o.progress,this.musicAudioSource.volume=this.musicVolume),this.updateProgress(e)},i.updateProgress=function(o){"sound"===o?(this.settingPopupNode.getChildByPath("Content/Sound/Slider").getComponent(l).progress=this.soundVolume,this.settingPopupNode.getChildByPath("Content/Sound/Slider/ProgressBar").getComponent(a).progress=this.soundVolume):"music"===o&&(this.settingPopupNode.getChildByPath("Content/Music/Slider").getComponent(l).progress=this.musicVolume,this.settingPopupNode.getChildByPath("Content/Music/Slider/ProgressBar").getComponent(a).progress=this.musicVolume)},i.playBGM=function(){},i.pauseBGM=function(){this.musicAudioSource.playing&&this.musicAudioSource.pause()},i.playBtnClick=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.btnClickClip,this.soundVolume)},i.playDown=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.downClip,this.soundVolume)},i.playMerge=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.mergeClip,this.soundVolume)},i.playGood=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.goodClip,this.soundVolume)},i.playUnbeliveable=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.unbeliveableClip,this.soundVolume)},i.playGameFail=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.gameFailClip,this.soundVolume)},i.playGameSuccess=function(){0!=p.getSoundFlag()&&this.soundAudioSource.playOneShot(this.gameSuccessClip,this.soundVolume)},i.onSettingOpen=function(){this.settingPopupNode.active=!0},i.onSettingClose=function(){this.settingPopupNode.active=!1},i.update=function(o){},n}(c))||g);n._RF.pop()}}}));

System.register("chunks:///_virtual/Down2048ColorGraphics.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var t,r,i,n,e,l,h,s,a;return{setters:[function(o){t=o.inheritsLoose},function(o){r=o.cclegacy,i=o._decorator,n=o.UITransform,e=o.Rect,l=o.Size,h=o.v2,s=o.Graphics,a=o.Component}],execute:function(){var c;r._RF.push({},"955f23LkQlJ2I6oo3ehQ2hA","Down2048ColorGraphics",void 0);var u=i.ccclass;i.property,o("Down2048ColorGraphics",u("Down2048ColorGraphics")(c=function(o){function r(){for(var t,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return(t=o.call.apply(o,[this].concat(i))||this).fillColor=null,t.radiusVal=10,t}t(r,o);var i=r.prototype;return i.start=function(){},i.redrawWithColor=function(o,t){void 0===t&&(t=10),this.fillColor=o,this.radiusVal=t,this.redraw()},i.redraw=function(){var o=this.node.getComponent(n).getBoundingBox(),t=new e;t.size=new l(o.width,o.height),t.center=h(.5*o.width-o.width*this.node.getComponent(n).anchorX,.5*o.height-o.height*this.node.getComponent(n).anchorY);var r=this.getComponent(s);r.clear(),r.roundRect(t.xMin,t.yMin,t.width,t.height,this.radiusVal),r.fillColor=this.fillColor,r.strokeColor=this.fillColor,r.fill(),r.stroke()},r}(a))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/Down2048GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Down2048AudioManager.ts","./SDKManager.ts","./Down2048Tool.ts"],(function(o){var t,e,i,n,r,a,d,l,s,u,g,c,h,f,m,w,v,p,C,N,G,S,D,P,I,b,B,y;return{setters:[function(o){t=o.inheritsLoose,e=o.createClass},function(o){i=o.cclegacy,n=o._decorator,r=o.find,a=o.Label,d=o.Node,l=o.assetManager,s=o.JsonAsset,u=o.Prefab,g=o.randomRangeInt,c=o.instantiate,h=o.UITransform,f=o.Sprite,m=o.Color,w=o.Size,v=o.v3,p=o.tween,C=o.Widget,N=o.UIOpacity,G=o.Vec2,S=o.Vec3,D=o.Button,P=o.director,I=o.Component},function(o){b=o.Down2048AudioManager},function(o){B=o.SDKManager},function(o){y=o.Down2048Tool}],execute:function(){var L;i._RF.push({},"43e4fCtPwZEOLlN+r8sQnKD","Down2048GameManager",void 0);var M=n.ccclass,x=(n.property,function(o){return o[o.init=0]="init",o[o.running=1]="running",o[o.end=2]="end",o[o.pause=3]="pause",o[o.remove=4]="remove",o}(x||{})),F=function(o){return o[o.notUse=0]="notUse",o[o.used=1]="used",o}(F||{});o("Down2048GameManager",M("Down2048GameManager")(L=function(o){function i(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(t=o.call.apply(o,[this].concat(i))||this).row=0,t.column=0,t.gridSize=0,t.gridMargin=0,t.downSpeed=10,t.aniGridZoomIn=0,t.aniGridZoomOut=0,t.aniColorGridDown=0,t.aniColorGridMerge=0,t.aniColorGridRemove=0,t.maxValue=2048,t.colors={2:{bgColor:"#DBDBDB",fontColor:"#ffffff"},4:{bgColor:"#ECD19F",fontColor:"#ffffff"},8:{bgColor:"#FFA455",fontColor:"#ffffff"},16:{bgColor:"#f59563",fontColor:"#ffffff"},32:{bgColor:"#f67c5f",fontColor:"#ffffff"},64:{bgColor:"#f65e3b",fontColor:"#ffffff"},128:{bgColor:"#edcf72",fontColor:"#ffffff"},256:{bgColor:"#edcc61",fontColor:"#ffffff"},512:{bgColor:"#edc850",fontColor:"#ffffff"},1024:{bgColor:"#edc53f",fontColor:"#ffffff"},2048:{bgColor:"#edc22e",fontColor:"#ffffff"}},t.bundleName="down2048",t.gameConfig={},t.gameStatus=null,t._score=0,t.deltaTime=1,t.gridList=[],t.downGridData=null,t.autoDownFlag=!1,t.downFlag=!1,t.loopMergeList=[],t.valueFontSize=0,t.removingFlag=!1,t._nextValue=null,t._nextValue2=null,t._nextColumnIdx=null,t.adShowingFlag=!1,t.gameTipShowCount=0,t.gameBestScore=0,t.colorNodePositions=[],t.colorNode1=null,t.colorNode2=null,t.audioManager=null,t.canvasNode=null,t.gridsNode=null,t.gridsColumnBGNode=null,t.colorGridsNode=null,t.runUINode=null,t.fpsLabel=null,t.scoreLabel=null,t.bestScoreLabel=null,t.gameTipNode=null,t.pausePopupNode=null,t.gameFailPopupNode=null,t.removePopupNode=null,t.removeColorGridsNode=null,t.nextValueLabel=null,t.loadingNode=null,t.nextValueBtnNode=null,t.bottomAdNode=null,t.gridPrefab=null,t.columnBGPrefab=null,t}t(i,o);var n=i.prototype;return n.setAdShowingFlag=function(o){var t=this;this.adShowingFlag=o,o?this.audioManager.pauseBGM():this.scheduleOnce((function(){t.audioManager.playBGM()}))},n.showBottomBannerAd=function(){var o=this.bottomAdNode.getWorldPosition().y;B.showBottomBannerAd(o).then((function(){})).catch((function(){}))},n.hideBottomBanner=function(){this.scheduleOnce((function(){B.hideBottomBanner()}))},n.onLoad=function(){this.audioManager=r("Down2048AudioManager").getComponent(b),this.canvasNode=r("Canvas"),this.gridsNode=this.canvasNode.getChildByPath("Grids"),this.gridsColumnBGNode=this.canvasNode.getChildByPath("GridsColumnBG"),this.colorGridsNode=this.canvasNode.getChildByPath("ColorGrids"),this.runUINode=this.canvasNode.getChildByPath("RunUI"),this.runUINode.active=!1,this.scoreLabel=this.runUINode.getChildByPath("Top/CurScore/Score").getComponent(a),this.bestScoreLabel=this.runUINode.getChildByPath("Top/BestScore/Score").getComponent(a),this.gameTipNode=this.runUINode.getChildByPath("GameTip"),this.gameTipNode.active=!1,this.pausePopupNode=this.canvasNode.getChildByPath("PausePopup"),this.pausePopupNode.active=!1,this.gameFailPopupNode=this.canvasNode.getChildByPath("GameFailPopup"),this.gameFailPopupNode.active=!1,this.removePopupNode=this.canvasNode.getChildByPath("RemovePopup"),this.removePopupNode.active=!1,this.removeColorGridsNode=this.removePopupNode.getChildByPath("Content/RemoveColorGrids"),this.nextValueLabel=this.runUINode.getChildByPath("NextValue").getComponent(a),this.nextValueLabel.node.active=!1,this.loadingNode=this.canvasNode.getChildByPath("Loading"),this.loadingNode.active=!0,this.nextValueBtnNode=this.runUINode.getChildByPath("Bottom/NextValue"),this.bottomAdNode=this.runUINode.getChildByPath("BottomAd"),this.canvasNode.on(d.EventType.TOUCH_START,(function(o){o.preventSwallow=!0})),this.canvasNode.on(d.EventType.TOUCH_MOVE,(function(o){o.preventSwallow=!0})),this.canvasNode.on(d.EventType.TOUCH_END,(function(o){o.preventSwallow=!0})),this.canvasNode.on(d.EventType.TOUCH_CANCEL,(function(o){o.preventSwallow=!0}))},n.start=function(){var o=this;this.scheduleOnce((function(){o.loadGameConfig().then((function(){o.loadAssert().then((function(){Object.keys(o.gameConfig.config).forEach((function(t){"//"!==t&&(o[t]=o.gameConfig.config[t])}));var t=o.gridSize/30;o.valueFontSize=Math.floor(19*t),B.initData(o.gameConfig.adConfig),o.showBottomBannerAd(),o.loadingNode.active=!1,o.initData()}))}))}),0)},n.onDestroy=function(){},n.loadGameConfig=function(){var o=this;return new Promise((function(t,e){l.loadBundle(o.bundleName,(function(i,n){i||n.load("down2048GameConfig",s,(function(i,n){if(i)return console.log("load gameconfig err:",i),void e(i);o.gameConfig=n.json,console.log("load gameconfig succes."),t(0)}))}))}))},n.loadAssert=function(){var o=this;return new Promise((function(t,e){var i=[],n={gridPrefab:"prefabs/Grid",columnBGPrefab:"prefabs/ColumnBG"};Object.keys(n).forEach((function(t){var e=n[t];i.push(new Promise((function(i,n){l.loadBundle(o.bundleName,(function(r,a){r||a.load(e,u,(function(e,r){if(e)return console.log("load err:",e),void n(e);o[t]=r,i(0)}))}))})))})),Promise.all([].concat(i,[o.audioManager.loadAssert()])).then((function(o){t(0)}))}))},n.setGameStauts=function(o){o!==this.gameStatus&&(this.gameStatus=o,this.gameStatus===x.init?(this.runUINode.active=!0,this.gameFailPopupNode.active=!1,this.pausePopupNode.active=!1):this.gameStatus===x.running?(this.runUINode.active=!0,this.pausePopupNode.active=!1,this.removePopupNode.active=!1):this.gameStatus===x.end?this.gameFailPopupNode.active=!0:this.gameStatus===x.pause?this.pausePopupNode.active=!0:this.gameStatus===x.remove&&(this.removePopupNode.active=!0))},n.randomGetNextValue=function(){var o=[2,4,8,16,32];return o[g(0,o.length)]},n.createColorNode=function(o,t){var e=c(this.gridPrefab);e.getComponent(h).setContentSize(this.gridSize-2*this.gridMargin,this.gridSize-2*this.gridMargin),e.setScale(.5,.5,.5),e.setPosition(t),e.getChildByPath("bg").getComponent(f).color=new m(this.colors[o].bgColor),this.colorGridsNode.addChild(e);var i=e.getChildByPath("Num").getComponent(a);return i.fontSize=this.valueFontSize,i.string=""+o,i.color=new m(this.colors[o].fontColor),e},n.initData=function(){var o=this;this.audioManager.playBGM(),this.setGameStauts(x.init),this.score=0,this.autoDownFlag=!1,this.downFlag=!1,this.downGridData=null,this.gridList=[],this.gridsNode.getComponent(h).setContentSize(w.ZERO),this.gridsNode.destroyAllChildren(),this.gridsColumnBGNode.destroyAllChildren(),this.loopMergeList.length=0,this.colorGridsNode.destroyAllChildren(),this.nextValueLabel.node.active=!1,this.nextValueBtnNode.active=!0,this.adShowingFlag=!1;var t=y.getBestScore();this.bestScoreLabel.string=""+t,this.generateGrids().then((function(){var t=v(0,o.gridsNode.getComponent(h).height/2+70,0),e=v(0,o.gridsNode.getComponent(h).height/2+100,0);o.colorNodePositions.push(t),o.colorNodePositions.push(e),null===o.nextValue&&(o.nextValue=o.randomGetNextValue(),o.nextValue2=o.randomGetNextValue()),o.colorNode1=o.createColorNode(o.nextValue,t),o.colorNode2=o.createColorNode(o.nextValue2,e),o.nextValueLabel.node.setWorldPosition(o.gridsNode.getWorldPosition().add3f(0,-(o.gridsNode.getComponent(h).height/2+20),0)),o.setGameStauts(x.running),o.generateColorGrid(),o.gameTipShowCount}))},n.generateGrids=function(){var o=this;return new Promise((function(t,e){var i=new w(o.gridSize*o.column+2*o.gridMargin,o.gridSize*o.row+2*o.gridMargin+4);p(o.gridsNode.getComponent(h)).to(0,{contentSize:i}).call((function(){for(var e=0;e<o.row;e++){o.gridList.push([]);for(var i=0;i<o.column;i++){var n={name:"Grid-"+e+"-"+i,gridStatus:F.notUse,gridNode:null,row:e,column:i,colorInfo:null};o.gridList[e].push(n),n.gridNode=new d,o.gridsNode.addChild(n.gridNode),n.gridNode.name="Grid-"+e+"-"+i,n.gridNode.addComponent(h).setContentSize(o.gridSize,o.gridSize);var r=n.gridNode.addComponent(C);r.isAlignLeft=!0,r.left=o.gridSize*i+o.gridMargin,r.isAlignBottom=!0,r.bottom=o.gridSize*e+o.gridMargin,o.addGridEvent(n)}}o.scheduleOnce((function(){for(var e=0;e<o.column;e++){var i=c(o.columnBGPrefab);o.gridsColumnBGNode.addChild(i),i.getComponent(h).setContentSize(o.gridSize-2*o.gridMargin,o.gridSize*o.row);var n=o.gridList[0][e].gridNode.getWorldPosition();n.subtract3f(0,o.gridSize/2-o.gridMargin,0),i.setWorldPosition(n)}t(!0)}))})).start()}))},n.generateColorGrid=function(){var o=this;null===this.nextColumnIdx?(this.nextColumnIdx=g(0,this.column),this.downGridData=this.gridList[this.row-1][this.nextColumnIdx]):this.downGridData=this.gridList[this.row-1][this.nextColumnIdx];var t=this.downGridData.gridNode.getWorldPosition().add3f(0,this.gridSize,0),e=this.nextValue,i=this.colorNode1;this.downGridData.colorInfo={value:e,colorNode:i},i.setWorldPosition(t),i.setScale(1,1,1),this.autoDownFlag=!0;var n=this.colorNode2.getComponent(N);p(this.colorNode2).parallel(p().to(.15,{position:this.colorNodePositions[0]},{easing:"quadOut"}),p(n).to(.15,{opacity:255})).call((function(){o.nextValue=o.nextValue2,o.colorNode1=o.colorNode2,o.nextValue2=o.randomGetNextValue(),o.colorNode2=o.createColorNode(o.nextValue2,o.colorNodePositions[1]),o.colorNode2.getComponent(N).opacity=0})).start(),this.downGridData.gridStatus=F.used,this.addColorGridEvent(i)},n.addColorGridEvent=function(o){var t=this;o.on(d.EventType.TOUCH_END,(function(e){if(t.gameStatus===x.remove){for(var i=null,n=0;n<t.row;n++)for(var r=0;r<t.column;r++){var a=t.gridList[n][r];a.gridStatus===F.used&&a.colorInfo.colorNode===o&&(i=a)}i!==t.downGridData&&t.removeColorGrid(i)}}))},n.addGridEvent=function(o){var t=this,e=o.gridNode;e.on(d.EventType.TOUCH_START,(function(e){t.gameStatus!==x.running||t.downFlag||t.adShowingFlag||(t.gameTipNode.active=!1,t.downColorGridMove(o))}),this),e.on(d.EventType.TOUCH_MOVE,(function(o){if(t.gameStatus===x.running&&!t.downFlag&&!t.adShowingFlag){for(var e=null,i=0;i<t.row;i++)for(var n=0;n<t.column;n++){var r=t.gridList[i][n],a=r.gridNode.getWorldPosition().toVec2();G.distance(a,o.getUILocation())<=t.gridSize/2&&(e=r)}null!==e&&t.downGridData.column!==e.column&&t.downColorGridMove(e)}}),this),e.on(d.EventType.TOUCH_END,this.onTouchEnd,this),e.on(d.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},n.onTouchEnd=function(o){var t=this;if(this.gameStatus===x.running&&!this.downFlag&&!this.adShowingFlag){this.downFlag=!0;for(var e=this.downGridData.row;e>0&&this.gridList[e-1][this.downGridData.column].gridStatus!==F.used;)e-=1;this.autoDownFlag=!1;var i=this.gridList[e][this.downGridData.column];p(this.downGridData.colorInfo.colorNode).to(this.aniColorGridDown,{worldPosition:i.gridNode.getWorldPosition()}).call((function(){t.downGridData!==i&&(i.colorInfo=t.downGridData.colorInfo,i.gridStatus=F.used,t.downGridData.colorInfo=null,t.downGridData.gridStatus=F.notUse,t.downGridData=i),t.downEnd()})).start()}},n.downColorGridMove=function(o){if(this.downGridData.column!==o.column){for(var t=o.column-this.downGridData.column<0,e=this.downGridData.column;e!==o.column;){if(this.gridList[this.downGridData.row][t?e-1:e+1].gridStatus===F.used)break;t?e-=1:e+=1}if(e!==this.downGridData.column){this.nextColumnIdx=e;var i=this.gridList[this.downGridData.row][e];i.colorInfo=this.downGridData.colorInfo,i.gridStatus=F.used,this.downGridData.colorInfo=null,this.downGridData.gridStatus=F.notUse,this.downGridData=i;var n=this.downGridData.colorInfo.colorNode.getWorldPosition();n.x=this.downGridData.gridNode.getWorldPosition().x,this.downGridData.colorInfo.colorNode.setWorldPosition(n)}}},n.downEnd=function(){this.autoDownFlag=!1,this.downGridData.colorInfo.colorNode.setWorldPosition(this.downGridData.gridNode.getWorldPosition()),this.audioManager.playDown();var o=this.downGridData;this.downGridData=null;var t=this.checkMergeData(o),e=!1;Object.keys(t).forEach((function(o){t[o].merge&&(e=!0)})),e?this.loopMerge(o):o.row===this.row-1?this.gameFail():(this.generateColorGrid(),this.downFlag=!1)},n.loopMerge=function(o){var t=this,e=this.checkMergeData(o);this.mergeColorGrid(o,e).then((function(i){if(i.merge){if(e.bottom.merge?t.loopMergeList.unshift(e.bottom.gridData):t.loopMergeList.unshift(o),e.left.merge&&e.left.gridData.gridStatus===F.used)for(var n=e.left.gridData.row;n<t.row;n++){var r=t.gridList[n][e.left.gridData.column];r.gridStatus===F.used&&r!==t.downGridData&&t.loopMergeList.push(r)}if(e.right.merge&&e.right.gridData.gridStatus===F.used)for(var a=e.right.gridData.row;a<t.row;a++){var d=t.gridList[a][e.right.gridData.column];d.gridStatus===F.used&&d!==t.downGridData&&t.loopMergeList.push(d)}t.loopMergeList.length>0&&t.loopMerge(t.loopMergeList.shift())}else t.loopMergeList.length<1?(t.downFlag=!1,t.gameStatus===x.remove?(t.removingFlag=!1,t.onRemoveCancel()):t.generateColorGrid()):t.loopMerge(t.loopMergeList.shift())}))},n.checkMergeData=function(o){var t=this,e={bottom:{check:{row:-1,column:0},merge:!1,moveTween:null,gridData:null},left:{check:{row:0,column:-1},merge:!1,moveTween:null,gridData:null},right:{check:{row:0,column:1},merge:!1,moveTween:null,gridData:null}};return o.gridStatus===F.notUse||o.colorInfo.value>=this.maxValue||Object.keys(e).forEach((function(i){var n=o.row+e[i].check.row,r=o.column+e[i].check.column;if(!(n<0||n>=t.row||r<0||r>=t.column)){var a=t.gridList[n][r];a.gridStatus===F.notUse||a===t.downGridData||a.gridStatus===F.used&&a.colorInfo.value!==o.colorInfo.value||(e[i].gridData=a,e[i].merge=!0,e[i].moveTween=p(a.colorInfo.colorNode).to(t.aniColorGridMerge,{worldPosition:o.colorInfo.colorNode.getWorldPosition()}))}})),e},n.mergeColorGrid=function(o,t){var e=this;return new Promise((function(i,n){var r,d={merge:!1},l=[];if(Object.keys(t).forEach((function(o){null!==t[o].moveTween&&(l.push(t[o].moveTween),e.gameStatus===x.remove?e.removeColorGridsNode.insertChild(t[o].gridData.colorInfo.colorNode,0):e.colorGridsNode.insertChild(t[o].gridData.colorInfo.colorNode,0))})),l.length<1)i(d);else{d.merge=!0,l.length>=3?e.audioManager.playUnbeliveable():e.audioManager.playMerge();var s=o.colorInfo.value;l.forEach((function(){s*=2})),s=s>2048?2048:s,o.colorInfo.value=s,e.score+=s;var u=o.colorInfo.colorNode.getChildByPath("bg").getComponent(f),g=o.colorInfo.colorNode.getChildByPath("Num").getComponent(a);(r=p(e.node)).parallel.apply(r,l).parallel(p(u).to(e.aniColorGridMerge,{color:new m(e.colors[o.colorInfo.value].bgColor)}),p(g).to(e.aniColorGridMerge,{string:""+o.colorInfo.value,color:new m(e.colors[o.colorInfo.value].fontColor)})).call((function(){var o;Object.keys(t).forEach((function(o){t[o].merge&&(t[o].gridData.colorInfo.colorNode.destroy(),t[o].gridData.colorInfo=null,t[o].gridData.gridStatus=F.notUse)}));var n=[];if(t.left.merge){for(var r=[],a=t.left.gridData.row+1;a<e.row;a++){var l=e.gridList[a][t.left.gridData.column];l.gridStatus===F.used&&l!==e.downGridData&&r.push(l)}for(var s=0;s<r.length;s++){var u=r[s],g=e.gridList[t.left.gridData.row+s][t.left.gridData.column];u!==g&&(g.colorInfo=u.colorInfo,g.gridStatus=F.used,u.colorInfo=null,u.gridStatus=F.notUse,n.push(p(g.colorInfo.colorNode).to(e.aniColorGridDown,{worldPosition:g.gridNode.getWorldPosition()})))}}if(t.right.merge){for(var c=[],h=t.right.gridData.row+1;h<e.row;h++){var f=e.gridList[h][t.right.gridData.column];f.gridStatus===F.used&&f!==e.downGridData&&c.push(f)}for(var m=0;m<c.length;m++){var w=c[m],v=e.gridList[t.right.gridData.row+m][t.right.gridData.column];w!==v&&(v.colorInfo=w.colorInfo,v.gridStatus=F.used,w.colorInfo=null,w.gridStatus=F.notUse,n.push(p(v.colorInfo.colorNode).to(e.aniColorGridDown,{worldPosition:v.gridNode.getWorldPosition()})))}}if(t.bottom.merge){for(var C=[],N=t.bottom.gridData.row;N<e.row;N++){var G=e.gridList[N][t.bottom.gridData.column];G.gridStatus===F.used&&G!==e.downGridData&&C.push(G)}for(var S=0;S<C.length;S++){var D=C[S],P=e.gridList[t.bottom.gridData.row+S][t.bottom.gridData.column];D!==P&&(P.colorInfo=D.colorInfo,P.gridStatus=F.used,D.colorInfo=null,D.gridStatus=F.notUse,n.push(p(P.colorInfo.colorNode).to(e.aniColorGridDown,{worldPosition:P.gridNode.getWorldPosition()})))}}n.length<1?i(d):(o=p(e.node)).parallel.apply(o,n).call((function(){i(d)})).start()})).start()}}))},n.gameFail=function(){this.gameFailPopupNode.getChildByPath("Content/Info").getChildByPath("NowScore").getComponent(a).string=""+this.score,this.setGameStauts(x.end),this.saveScore(),this.audioManager.playGameFail()},n.onPauseBtnClick=function(){this.gameStatus===x.running&&(this.setGameStauts(x.pause),this.audioManager.pauseBGM())},n.onContinueBtnClick=function(){this.setGameStauts(x.running),this.audioManager.playBGM()},n.onAgainBtnClick=function(){this.initData()},n.removeColorGrid=function(o){var t=this;this.removingFlag||(this.removingFlag=!0,p(o.colorInfo.colorNode).to(this.aniColorGridRemove,{scale:S.ZERO}).call((function(){var e;if(o.colorInfo.colorNode.destroy(),o.colorInfo=null,o.gridStatus=F.notUse,o.row+1>=t.row||t.gridList[o.row+1][o.column].gridStatus===F.notUse)return t.removingFlag=!1,void t.onRemoveCancel();for(var i=[],n=[],r=o.row+1;r<t.row;r++){var a=t.gridList[r][o.column];if(a===t.downGridData)break;a.gridStatus===F.used&&n.push(a)}for(var d=0;d<n.length;d++){var l=n[d],s=t.gridList[o.row+d][o.column];l!==s&&(s.colorInfo=l.colorInfo,s.gridStatus=F.used,l.colorInfo=null,l.gridStatus=F.notUse,i.push(p(s.colorInfo.colorNode).to(t.aniColorGridDown,{worldPosition:s.gridNode.getWorldPosition()})))}(e=p(t.node)).parallel.apply(e,i).call((function(){for(var e,i=[],n=o.row;n<t.row;n++){var r=t.gridList[n][o.column];r.gridStatus===F.used&&r!==t.downGridData&&i.push(r)}var a=i.shift();(e=t.loopMergeList).push.apply(e,i),t.loopMerge(a)})).start()})).start())},n.onRemoveBtnClick=function(){var o=this;this.downFlag||this.adShowingFlag||this.gameStatus!==x.running||(this.setAdShowingFlag(!0),B.showVideoAd().then((function(t){if(t){o.setGameStauts(x.remove);for(var e=0;e<o.row;e++)for(var i=0;i<o.column;i++){var n=o.gridList[e][i];n.gridStatus!==F.notUse&&n!==o.downGridData&&(n.colorInfo.colorNode.getComponent(D).enabled=!0,o.removeColorGridsNode.addChild(n.colorInfo.colorNode))}}o.setAdShowingFlag(!1)})).catch((function(t){console.error("onRemoveBtnClick",t),o.setAdShowingFlag(!1)})))},n.onRemoveCancel=function(){if(!this.removingFlag){for(var o=0;o<this.row;o++)for(var t=0;t<this.column;t++){var e=this.gridList[o][t];e.gridStatus!==F.notUse&&e!==this.downGridData&&(e.colorInfo.colorNode.getComponent(D).enabled=!1,this.colorGridsNode.addChild(e.colorInfo.colorNode))}this.setGameStauts(x.running)}},n.onNextValueBtnClick=function(){var o=this;this.downFlag||this.adShowingFlag||this.gameStatus!==x.running||(this.setAdShowingFlag(!0),B.showVideoAd().then((function(t){t&&(o.nextValueLabel.node.active=!0,o.nextValueBtnNode.active=!1),o.setAdShowingFlag(!1)})).catch((function(t){console.error("onNextValueBtnClick",t),o.setAdShowingFlag(!1)})))},n.backAction=function(){P.loadScene("down2048Start")},n.showInterstitialAd=function(o){o.active=!1,B.showInterstitialAd().then((function(t){o.active=!0})).catch((function(t){o.active=!0})),this.scheduleOnce((function(){o.active=!0}),1)},n.update=function(o){if(this.deltaTime=o,this.gameStatus===x.running&&!this.adShowingFlag&&this.autoDownFlag&&!this.adShowingFlag){var t=this.downGridData.colorInfo.colorNode.getWorldPosition();if(t.subtract3f(0,this.downSpeed*o,0),this.downGridData.colorInfo.colorNode.setWorldPosition(t),this.downGridData.row>0&&this.gridList[this.downGridData.row-1][this.downGridData.column].gridStatus===F.notUse&&G.distance(this.gridList[this.downGridData.row-1][this.downGridData.column].gridNode.getWorldPosition(),this.downGridData.colorInfo.colorNode.getWorldPosition())<=this.gridSize){var e=this.gridList[this.downGridData.row-1][this.downGridData.column];e.colorInfo=this.downGridData.colorInfo,e.gridStatus=F.used,this.downGridData.colorInfo=null,this.downGridData.gridStatus=F.notUse,this.downGridData=e}this.downGridData.colorInfo.colorNode.getWorldPosition().y<=this.downGridData.gridNode.getWorldPosition().y&&this.downEnd()}},n.saveScore=function(){if(window.submitScore&&window.Telegram){var o=window.Telegram.WebApp.initDataUnsafe.user,t=o.id.toString(),e=o.username,i=o.photo_url;window.submitScore(t,{nickName:e,avatarUrl:i},this.score)}},e(i,[{key:"score",get:function(){return this._score},set:function(o){this._score=o,this.scoreLabel.string=""+this._score,o>this.gameBestScore&&(this.gameBestScore=o,this.bestScoreLabel.string=""+this.gameBestScore,y.storeBestScore(this.gameBestScore))}},{key:"nextValue",get:function(){return this._nextValue},set:function(o){this._nextValue=o,this.nextValueLabel.string="下个数值："+this._nextValue}},{key:"nextValue2",get:function(){return this._nextValue2},set:function(o){this._nextValue2=o}},{key:"nextColumnIdx",get:function(){return this._nextColumnIdx},set:function(o){this._nextColumnIdx=o}}]),i}(I))||L);i._RF.pop()}}}));

System.register("chunks:///_virtual/Down2048RankView.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,t,o,r,i,a,l,s,c,u,p,d,g,h,f,m,y,w,C;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized,i=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){l=e.cclegacy,s=e._decorator,c=e.ScrollView,u=e.Node,p=e.Prefab,d=e.Label,g=e.instantiate,h=e.Vec3,f=e.tween,m=e.resources,y=e.SpriteFrame,w=e.Component,C=e.UITransform}],execute:function(){var b,I,v,k,P,B,N,S,R,z,L,T,V;l._RF.push({},"63ed2zkLaFOEIQoLzd90Wlo","Down2048RankView",void 0);var D=s.ccclass,U=s.property;e("Down2048RankView",(b=D("Down2048RankView"),I=U(c),v=U(u),k=U(p),P=U(u),B=U(u),b((R=n((S=function(e){function n(){for(var n,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i))||this,o(n,"scrollView",R,r(n)),o(n,"UIPop",z,r(n)),o(n,"leaderboardItem",L,r(n)),o(n,"content",T,r(n)),o(n,"loading",V,r(n)),n.playId=null,n.index=null,n}t(n,e);var l=n.prototype;return l.onEnable=function(){this.init()},l.start=function(){},l.update=function(e){},l.init=function(){var e=i(a().mark((function e(){var n,t,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.loading.active=!0,this.content.removeAllChildren(),this.scrollView.scrollToTop(0),window.Telegram&&(n=window.Telegram.WebApp.initDataUnsafe.user,t=n.id.toString(),this.playId=t),window.loadTopScores&&window.loadTopScores((function(e){e.forEach((function(e,n){}));var n=40*e.length;o.content.getComponent(C).setContentSize(220,n);var t=e;if(t){o.loading.active=!1;for(var r=0;r<t.length;r++)o.updateRankList(t[r],r);o.updateUseScore(t[o.index],o.index)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.updateUseScore=function(e,n){var t=this.node.getChildByPath("popUI/PlayerItem");t.getChildByName("rankLabel").getComponent(d).string=null!==n?String(n+1):"Not Ranked",e?(t.getChildByPath("userInfo/name").getComponent(d).string=e.playerInfo.nickName,t.getChildByPath("scoreNode/score").getComponent(d).string=e.score):(t.getChildByPath("userInfo/name").getComponent(d).string="Anonymous",t.getChildByPath("scoreNode/score").getComponent(d).string="0")},l.updateRankList=function(e,n){var t,o,r=g(this.leaderboardItem);(r.parent=this.content,r.position=new h(-510,-60-100*n,0),r.getChildByName("rankLabel").getComponent(d).string=String(n+1),r.removeChild(r.getChildByName("rank")),e.playerInfo.avatarUrl,e&&e.playerId==this.playId)?(r.getChildByPath("userInfo/name").getComponent(d).string=e.playerInfo.nickName||"Me",r.getChildByPath("scoreNode/score").getComponent(d).string=e&&e.score?e.score:0,this.index=n):(r.getChildByPath("userInfo/name").getComponent(d).string=e&&null!=(t=e.playerInfo)&&t.nickName?null==e||null==(o=e.playerInfo)?void 0:o.nickName:"",r.getChildByPath("scoreNode/score").getComponent(d).string=e&&e.score?e.score:0);f(r).to(1*n*.1,{position:new h(0,-60-100*n,0)}).start()},l.calback=function(){this.node.active=!1},l.loadResourceSprite=function(e,n){m.load(n,y,(function(n,t){n?console.log(n):e.spriteFrame=t}))},n}(w)).prototype,"scrollView",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=n(S.prototype,"UIPop",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=n(S.prototype,"leaderboardItem",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=n(S.prototype,"content",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=n(S.prototype,"loading",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=S))||N));l._RF.pop()}}}));

System.register("chunks:///_virtual/down2048Start.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Down2048Tool.ts"],(function(n){var t,e,o,r,i,a,u,c,s,l;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.inheritsLoose,o=n.initializerDefineProperty,r=n.assertThisInitialized},function(n){i=n.cclegacy,a=n._decorator,u=n.Node,c=n.director,s=n.Component},function(n){l=n.Down2048Tool}],execute:function(){var f,d,p,h,g,w,m,S,b;i._RF.push({},"72037aZSHVD1aa1lunc+0yN","down2048Start",void 0);var v=a.ccclass,y=a.property;n("down2048Start",(f=v("down2048Start"),d=y(u),p=y(u),h=y(u),f((m=t((w=function(n){function t(){for(var t,e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return t=n.call.apply(n,[this].concat(i))||this,o(t,"soundOnIcon",m,r(t)),o(t,"soundOffIcon",S,r(t)),o(t,"rankView",b,r(t)),t}e(t,n);var i=t.prototype;return i.start=function(){this.refreshSoundStatus()},i.update=function(n){},i.startGameAction=function(){c.loadScene("down2048")},i.refreshSoundStatus=function(){1==l.getSoundFlag()?(this.soundOnIcon.active=!0,this.soundOffIcon.active=!1):(this.soundOnIcon.active=!1,this.soundOffIcon.active=!0)},i.soundGameAction=function(){1==l.getSoundFlag()?l.setSoundFlag(0):l.setSoundFlag(1),this.refreshSoundStatus()},i.shareGameAction=function(){l.shareTelegram()},i.moreGameAction=function(){window.Telegram&&window.Telegram.WebApp.openTelegramLink("https://t.me/bestpuzzlegame")},i.rankGameAction=function(){this.rankView.active=!0},t}(s)).prototype,"soundOnIcon",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(w.prototype,"soundOffIcon",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(w.prototype,"rankView",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=w))||g));i._RF.pop()}}}));

System.register("chunks:///_virtual/Down2048Tool.ts",["cc"],(function(e){var t,o;return{setters:[function(e){t=e.cclegacy,o=e._decorator}],execute:function(){var n,r;t._RF.push({},"e31782sxKRLJK6NyiwaYtTA","Down2048Tool",void 0);var a=o.ccclass;o.property,e("Down2048Tool",a("Down2048Tool")(((r=function(){function e(){}return e.getBestScore=function(){var t=localStorage.getItem(e.DOWN2048BESTSCORE);return null==t||null==t?0:parseInt(t)},e.storeBestScore=function(t){t>e.getBestScore()&&localStorage.setItem(e.DOWN2048BESTSCORE,t.toString())},e.storeDownGame=function(){},e.getDownGame=function(){},e.getSoundFlag=function(){var e=localStorage.getItem("__soundFlag__");return null==e||null==e?1:parseInt(e)},e.setSoundFlag=function(e){localStorage.setItem("__soundFlag__",""+e)},e.shareTelegram=function(){if(window.Telegram){var e=window.Telegram.WebApp.initDataUnsafe.user.id.toString(),t="https://t.me/share/url?url="+encodeURIComponent("https://t.me/Down2048Bot/Down2048?startapp="+e)+"&text="+encodeURIComponent("I just discovered an awesome game — Down2048! Can you beat my score? Let's find out!");window.Telegram.WebApp.openTelegramLink(t)}},e}()).DOWN2048BESTSCORE="__down2048BestScore__",n=r))||n);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Down2048AudioManager.ts","./Down2048ColorGraphics.ts","./Down2048GameManager.ts","./Down2048RankView.ts","./Down2048Tool.ts","./SDKManager.ts","./down2048Start.ts"],(function(){return{setters:[null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/SDKManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o;return{setters:[function(t){n=t.createClass},function(t){e=t.cclegacy,o=t.sys}],execute:function(){e._RF.push({},"cb2b3ellaBOu5vg2OD6khNS","SDKManager",void 0);var r=t("SDKManager",function(){function t(){}return t.recordEnterGameTime=function(){null===t.enterGameTime&&(t.enterGameTime=(new Date).getTime())},t.initData=function(n){console.log("sys.platform",o.platform),t.recordEnterGameTime(),Object.keys(n).forEach((function(e){"//"!==e&&(t[e]=n[e])})),t.isWX&&"undefined"!=typeof wx&&void 0!==wx.createInterstitialAd&&null===t.wxInterstitialAd&&(t.wxInterstitialAd=wx.createInterstitialAd({adUnitId:t.wxInterstitialAdId}))},t.showVideoAd=function(){return new Promise((function(t,n){}))},t.showInterstitialAd=function(){return new Promise((function(t,n){(new Date).getTime()}))},t.showBottomBannerAd=function(n){return void 0===n&&(n=null),new Promise((function(e,r){try{if(null!==n&&n<110)return console.log("底部空间不足展示banner!",n,110),void e(!1);if(t.isWX){if("undefined"==typeof wx||void 0===wx.createCustomAd)return void r("未定义wx或wx.createCustomAd。");if(null!==t.bottomBannerAd)return void t.bottomBannerAd.show().then((function(){e(!0)})).catch((function(n){console.log("banner广告组件出现问题",n),t.bottomBannerAd.destroy(),t.bottomBannerAd=null,r(n)}));var i=wx.getWindowInfo(),l=i.windowWidth,a=i.windowHeight,d=wx.createCustomAd({adIntervals:180,adUnitId:t.wxCustomAdId,style:{width:300,left:(l-300)/2,top:a-100-10}});t.bottomBannerAd=d,d.onError((function(n){console.error(n.errMsg),t.bottomBannerAd.destroy(),t.bottomBannerAd=null})),d.show().then((function(){e(!0)}))}else t.isDY?r(""):o.platform===o.Platform.MOBILE_BROWSER||o.platform===o.Platform.DESKTOP_BROWSER||o.platform===o.Platform.EDITOR_PAGE?e(!0):e(!1)}catch(t){console.error("showBannerAd",t),r(t)}}))},t.hideBottomBanner=function(){null!==t.bottomBannerAd&&t.bottomBannerAd.hide()},n(t,null,[{key:"isWX",get:function(){return o.platform===o.Platform.WECHAT_GAME||o.platform===o.Platform.WECHAT_MINI_PROGRAM}},{key:"isDY",get:function(){return o.platform===o.Platform.BYTEDANCE_MINI_GAME}}]),t}());r.wxVideoAdId=null,r.dyVideoAdId=null,r.wxInterstitialAdId=null,r.dyInterstitialAdId=null,r.wxCustomAdId=null,r.dyBannerAdId=null,r.firstInterstitialAdTime=30,r.interstitialAdInterval=120,r.interstitialAdNumLimit=15,r.wxInterstitialAd=null,r.enterGameTime=null,r.interstitialAdShowTime=0,r.interstitialAdShowCount=0,r.bottomBannerAd=null,r.wxUserInfoButton=null,e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});